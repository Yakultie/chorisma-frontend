{"ast":null,"code":"\"use strict\";\n\nconst {\n  setupForSimpleEventAccessors\n} = require(\"../helpers/create-event-accessor\");\nconst {\n  fireAnEvent\n} = require(\"../helpers/events\");\nconst EventTargetImpl = require(\"../events/EventTarget-impl\").implementation;\nconst AbortSignal = require(\"../generated/AbortSignal\");\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\nclass AbortSignalImpl extends EventTargetImpl {\n  constructor(globalObject, args, privateData) {\n    super(globalObject, args, privateData);\n\n    // make event firing possible\n    this._ownerDocument = globalObject.document;\n    this.reason = undefined;\n    this.abortAlgorithms = new Set();\n  }\n  get aborted() {\n    return this.reason !== undefined;\n  }\n  throwIfAborted() {\n    if (this.aborted) {\n      throw this.reason;\n    }\n  }\n  static abort(globalObject, reason) {\n    const abortSignal = AbortSignal.createImpl(globalObject, []);\n    if (reason !== undefined) {\n      abortSignal.reason = reason;\n    } else {\n      abortSignal.reason = DOMException.create(globalObject, [\"The operation was aborted.\", \"AbortError\"]);\n    }\n    return abortSignal;\n  }\n  static timeout(globalObject, milliseconds) {\n    const signal = AbortSignal.createImpl(globalObject, []);\n    globalObject.setTimeout(() => {\n      signal._signalAbort(DOMException.create(globalObject, [\"The operation timed out.\", \"TimeoutError\"]));\n    }, milliseconds);\n    return signal;\n  }\n  _signalAbort(reason) {\n    if (this.aborted) {\n      return;\n    }\n    if (reason !== undefined) {\n      this.reason = reason;\n    } else {\n      this.reason = DOMException.create(this._globalObject, [\"The operation was aborted.\", \"AbortError\"]);\n    }\n    for (const algorithm of this.abortAlgorithms) {\n      algorithm();\n    }\n    this.abortAlgorithms.clear();\n    fireAnEvent(\"abort\", this);\n  }\n  _addAlgorithm(algorithm) {\n    if (this.aborted) {\n      return;\n    }\n    this.abortAlgorithms.add(algorithm);\n  }\n  _removeAlgorithm(algorithm) {\n    this.abortAlgorithms.delete(algorithm);\n  }\n}\nsetupForSimpleEventAccessors(AbortSignalImpl.prototype, [\"abort\"]);\nmodule.exports = {\n  implementation: AbortSignalImpl\n};","map":{"version":3,"names":["setupForSimpleEventAccessors","require","fireAnEvent","EventTargetImpl","implementation","AbortSignal","DOMException","AbortSignalImpl","constructor","globalObject","args","privateData","_ownerDocument","document","reason","undefined","abortAlgorithms","Set","aborted","throwIfAborted","abort","abortSignal","createImpl","create","timeout","milliseconds","signal","setTimeout","_signalAbort","_globalObject","algorithm","clear","_addAlgorithm","add","_removeAlgorithm","delete","prototype","module","exports"],"sources":["/Users/bernard/Downloads/my-app/node_modules/jsdom/lib/jsdom/living/aborting/AbortSignal-impl.js"],"sourcesContent":["\"use strict\";\n\nconst { setupForSimpleEventAccessors } = require(\"../helpers/create-event-accessor\");\nconst { fireAnEvent } = require(\"../helpers/events\");\nconst EventTargetImpl = require(\"../events/EventTarget-impl\").implementation;\nconst AbortSignal = require(\"../generated/AbortSignal\");\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\n\nclass AbortSignalImpl extends EventTargetImpl {\n  constructor(globalObject, args, privateData) {\n    super(globalObject, args, privateData);\n\n    // make event firing possible\n    this._ownerDocument = globalObject.document;\n\n    this.reason = undefined;\n    this.abortAlgorithms = new Set();\n  }\n\n  get aborted() {\n    return this.reason !== undefined;\n  }\n\n  throwIfAborted() {\n    if (this.aborted) {\n      throw this.reason;\n    }\n  }\n\n  static abort(globalObject, reason) {\n    const abortSignal = AbortSignal.createImpl(globalObject, []);\n    if (reason !== undefined) {\n      abortSignal.reason = reason;\n    } else {\n      abortSignal.reason = DOMException.create(globalObject, [\"The operation was aborted.\", \"AbortError\"]);\n    }\n    return abortSignal;\n  }\n\n  static timeout(globalObject, milliseconds) {\n    const signal = AbortSignal.createImpl(globalObject, []);\n    globalObject.setTimeout(() => {\n      signal._signalAbort(DOMException.create(globalObject, [\"The operation timed out.\", \"TimeoutError\"]));\n    }, milliseconds);\n\n    return signal;\n  }\n\n  _signalAbort(reason) {\n    if (this.aborted) {\n      return;\n    }\n\n    if (reason !== undefined) {\n      this.reason = reason;\n    } else {\n      this.reason = DOMException.create(this._globalObject, [\"The operation was aborted.\", \"AbortError\"]);\n    }\n\n    for (const algorithm of this.abortAlgorithms) {\n      algorithm();\n    }\n    this.abortAlgorithms.clear();\n\n    fireAnEvent(\"abort\", this);\n  }\n\n  _addAlgorithm(algorithm) {\n    if (this.aborted) {\n      return;\n    }\n    this.abortAlgorithms.add(algorithm);\n  }\n\n  _removeAlgorithm(algorithm) {\n    this.abortAlgorithms.delete(algorithm);\n  }\n}\n\nsetupForSimpleEventAccessors(AbortSignalImpl.prototype, [\"abort\"]);\n\nmodule.exports = {\n  implementation: AbortSignalImpl\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}