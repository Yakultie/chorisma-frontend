{"ast":null,"code":"\"use strict\";\n\nconst {\n  domSymbolTree\n} = require(\"../helpers/internal-constants\");\nconst {\n  filter,\n  FILTER_ACCEPT\n} = require(\"./helpers\");\nexports.implementation = class NodeIteratorImpl {\n  constructor(globalObject, args, privateData) {\n    this._active = false;\n    this.root = privateData.root;\n    this.whatToShow = privateData.whatToShow;\n    this.filter = privateData.filter;\n    this._referenceNode = this.root;\n    this._pointerBeforeReferenceNode = true;\n    this._globalObject = globalObject;\n  }\n  get referenceNode() {\n    return this._referenceNode;\n  }\n  get pointerBeforeReferenceNode() {\n    return this._pointerBeforeReferenceNode;\n  }\n  nextNode() {\n    return this._traverse(\"next\");\n  }\n  previousNode() {\n    return this._traverse(\"previous\");\n  }\n  detach() {\n    // Intentionally do nothing, per spec.\n  }\n\n  // Called by Documents.\n  _preRemovingSteps(toBeRemovedNode) {\n    // Second clause is https://github.com/whatwg/dom/issues/496\n    if (!toBeRemovedNode.contains(this._referenceNode) || toBeRemovedNode === this.root) {\n      return;\n    }\n    if (this._pointerBeforeReferenceNode) {\n      let next = null;\n      let candidateForNext = domSymbolTree.following(toBeRemovedNode, {\n        skipChildren: true\n      });\n      while (candidateForNext !== null) {\n        if (this.root.contains(candidateForNext)) {\n          next = candidateForNext;\n          break;\n        }\n        candidateForNext = domSymbolTree.following(candidateForNext, {\n          skipChildren: true\n        });\n      }\n      if (next !== null) {\n        this._referenceNode = next;\n        return;\n      }\n      this._pointerBeforeReferenceNode = false;\n    }\n    const {\n      previousSibling\n    } = toBeRemovedNode;\n    this._referenceNode = previousSibling === null ? toBeRemovedNode.parentNode : domSymbolTree.lastInclusiveDescendant(toBeRemovedNode.previousSibling);\n  }\n  _traverse(direction) {\n    let node = this._referenceNode;\n    let beforeNode = this._pointerBeforeReferenceNode;\n    while (true) {\n      if (direction === \"next\") {\n        if (!beforeNode) {\n          node = domSymbolTree.following(node, {\n            root: this.root\n          });\n          if (!node) {\n            return null;\n          }\n        }\n        beforeNode = false;\n      } else if (direction === \"previous\") {\n        if (beforeNode) {\n          node = domSymbolTree.preceding(node, {\n            root: this.root\n          });\n          if (!node) {\n            return null;\n          }\n        }\n        beforeNode = true;\n      }\n      const result = filter(this, node);\n      if (result === FILTER_ACCEPT) {\n        break;\n      }\n    }\n    this._referenceNode = node;\n    this._pointerBeforeReferenceNode = beforeNode;\n    return node;\n  }\n};","map":{"version":3,"names":["domSymbolTree","require","filter","FILTER_ACCEPT","exports","implementation","NodeIteratorImpl","constructor","globalObject","args","privateData","_active","root","whatToShow","_referenceNode","_pointerBeforeReferenceNode","_globalObject","referenceNode","pointerBeforeReferenceNode","nextNode","_traverse","previousNode","detach","_preRemovingSteps","toBeRemovedNode","contains","next","candidateForNext","following","skipChildren","previousSibling","parentNode","lastInclusiveDescendant","direction","node","beforeNode","preceding","result"],"sources":["/Users/bernard/Downloads/my-app/node_modules/jsdom/lib/jsdom/living/traversal/NodeIterator-impl.js"],"sourcesContent":["\"use strict\";\nconst { domSymbolTree } = require(\"../helpers/internal-constants\");\nconst { filter, FILTER_ACCEPT } = require(\"./helpers\");\n\nexports.implementation = class NodeIteratorImpl {\n  constructor(globalObject, args, privateData) {\n    this._active = false;\n    this.root = privateData.root;\n    this.whatToShow = privateData.whatToShow;\n    this.filter = privateData.filter;\n\n    this._referenceNode = this.root;\n    this._pointerBeforeReferenceNode = true;\n\n    this._globalObject = globalObject;\n  }\n\n  get referenceNode() {\n    return this._referenceNode;\n  }\n\n  get pointerBeforeReferenceNode() {\n    return this._pointerBeforeReferenceNode;\n  }\n\n  nextNode() {\n    return this._traverse(\"next\");\n  }\n\n  previousNode() {\n    return this._traverse(\"previous\");\n  }\n\n  detach() {\n    // Intentionally do nothing, per spec.\n  }\n\n  // Called by Documents.\n  _preRemovingSteps(toBeRemovedNode) {\n    // Second clause is https://github.com/whatwg/dom/issues/496\n    if (!toBeRemovedNode.contains(this._referenceNode) || toBeRemovedNode === this.root) {\n      return;\n    }\n\n    if (this._pointerBeforeReferenceNode) {\n      let next = null;\n      let candidateForNext = domSymbolTree.following(toBeRemovedNode, { skipChildren: true });\n      while (candidateForNext !== null) {\n        if (this.root.contains(candidateForNext)) {\n          next = candidateForNext;\n          break;\n        }\n        candidateForNext = domSymbolTree.following(candidateForNext, { skipChildren: true });\n      }\n\n      if (next !== null) {\n        this._referenceNode = next;\n        return;\n      }\n\n      this._pointerBeforeReferenceNode = false;\n    }\n\n    const { previousSibling } = toBeRemovedNode;\n    this._referenceNode = previousSibling === null ?\n                          toBeRemovedNode.parentNode :\n                          domSymbolTree.lastInclusiveDescendant(toBeRemovedNode.previousSibling);\n  }\n\n  _traverse(direction) {\n    let node = this._referenceNode;\n    let beforeNode = this._pointerBeforeReferenceNode;\n\n    while (true) {\n      if (direction === \"next\") {\n        if (!beforeNode) {\n          node = domSymbolTree.following(node, { root: this.root });\n\n          if (!node) {\n            return null;\n          }\n        }\n\n        beforeNode = false;\n      } else if (direction === \"previous\") {\n        if (beforeNode) {\n          node = domSymbolTree.preceding(node, { root: this.root });\n\n          if (!node) {\n            return null;\n          }\n        }\n\n        beforeNode = true;\n      }\n\n      const result = filter(this, node);\n      if (result === FILTER_ACCEPT) {\n        break;\n      }\n    }\n\n    this._referenceNode = node;\n    this._pointerBeforeReferenceNode = beforeNode;\n    return node;\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}